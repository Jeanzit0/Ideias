const prompt = require('prompt-sync')();
const mysql = require('mysql2');

const connection = mysql.createConnection({
  host: 'localhost',
  user: 'root',
  password: '061165Jean2003.',
  database: 'controledegastos'
});

let saldoAtual = 0;

console.log('----------------------\n|| Próximo destino? ||\n----------------------');
console.log('<(1) BANCO (1)>');
let escolhaMenu = Number(prompt('<(0) O VAZIO (0)>'));
  
if (escolhaMenu == 1) {
  console.log('(: D) --> (Bem vindo ao banco, no que posso te ajudar?)\n');
  console.log('<(1) Registrar/conferir saldo atual (1)>');
  console.log('<(2)Registrar nova compra(2)>')
  let escolhaMenuBanco = Number(prompt('<(0) Isso foi um erro! (0)>'));

  if (escolhaMenuBanco == 1) {
    let respSaldoNovo = Number(prompt('Qual quantia? '));

    // Recupera o saldo atual do banco de dados
    connection.query('SELECT saldoAtual FROM controledesalario', (err, results) => {
      if (err) {
        console.error('Erro ao recuperar o saldo atual:', err);
        return;
      }

      saldoAtual = results[0]?.saldoAtual || 0;

      saldoAtual += respSaldoNovo;

      console.log(`\nSeu saldo atual é de: ${saldoAtual}\n`);

      connection.query('UPDATE controledesalario SET saldoAtual = ? WHERE id = 1', [saldoAtual], (err) => {
        if (err) {
          console.error('Erro ao atualizar o saldo no banco de dados:', err);
        } else {
          console.log('Saldo atualizado com sucesso!');
        }
      });
    });
  }
}else if(escolhaMenuBanco == 2){
      let item = prompt('Qual produto você comprou?');
      let qntd = prompt('Qual a quantidade?');
      let preco = prompt('Qual o valor do produto você comprou?');
      let credDebDin = prompt('Foi no (1) crédito / (2) débito / (3) dinheiro');
      let onde = prompt('Onde você comprou?');
      let obs = prompt('Obervações?');



} else if (escolhaMenu == 0) {
  console.log('\nAté mais viajante!');
}



// banco de dados:
// controledegastos (database)
// controledesalario (table)
//   | saldoAtual | bigint   | YES  |     | NULL    |                |
//   | datahora   | datetime | YES  |     | NULL    |                |
//   | id         | int      | NO   | PRI | NULL    | auto_increment |


/////////// CRIAR TABELA /////////////
// controledegastos (database)
// registrodecompra (table)
//     | 
//     |
//     |  create table registrodecompra(
//       -> id INT AUTO_INCREMENT PRIMARY KEY,
//       -> nome VARCHAR(75)
//       -> quantidade INT
//       -> nome VARCHAR(75),
//       -> quantidade INT,
//       -> preco BIGINT,
//       -> onde VARCHAR(75),
//       -> obs VARCHAR(300)
//       -> );
  
